# HANDOFF (Craftsman)

_Generated: 2026-01-23_

## Start Here
- Read: `docs/CONTEXT.md`
- Process: `docs/PROCESS.md`
- Recent changes: `docs/WORKLOG.md`

## Working Agreement (important)
- Mode 1 — ChatGPT (Чат): готовим ТЗ/план/проверки, задаём до 3 уточняющих вопросов. **Файлы репозитория не меняем**.
- Mode 2 — Codex (Агент): по готовому ТЗ **правит репозиторий по умолчанию**, этапами, с проверками.
- Commits/push: делает пользователь вручную, если явно не попросили агента сделать commit/push.

## Snapshot: Проект
- Название: `craftsman` (десктоп‑редактор для писателей)
- Технологии: Electron + vanilla HTML/CSS/JS
- Режим: полностью оффлайн
- Данные: простой текст `.txt`
- Хранение: локально на компьютере пользователя
- Бэкапы: обязательные локальные автосоздаваемые бэкапы

## Snapshot: MVP правила
- Никаких аккаунтов/авторизации
- Никаких сетевых запросов/облаков/синхронизаций
- Минимум зависимостей и “архитектуры на будущее”
- Любые крупные изменения — поэтапно, с минимальным риском регрессий

## Snapshot: Следующие шаги
1) Inline‑рендер `*...*` и `` `...` `` (без скрытия маркеров, но с приглушением).
2) Проверить undo/redo; при необходимости внедрить undo‑стек.
3) Уточнить/довести визуальные параметры под референсы (светлая/тёмная тема).
4) Прогнать ручные проверки из ТЗ: стили, курсор, сохранение/открытие, вставка, производительность.

## Snapshot: Перспектива (после MVP)
Зафиксированное видение (2026-01-23). Это **не** меняет ограничения MVP и не оправдывает “архитектуру на будущее” в текущем коде — только ориентир.

- Аудитория: автор + широкая аудитория.
- Платформы (возможная последовательность): довести macOS до “идеала” → web‑версия → мобильная версия → остальные платформы (Windows/Linux/Android/iOS).
- После MVP: сеть/облако/синхронизация → аккаунты → совместное редактирование (как в Google Docs).
- Экспорт: несколько форматов (после MVP).
- Масштаб текста: от 1 страницы до ~1000+; избегаем искусственных ограничений.
- Формат работы с файлами: один файл или много файлов — выбирается пользователем в настройках (после MVP / уточнить UX).
- Структура “проект/книга” в sidebar — опционально; планируются интеллект‑карты/майнд‑мэпы.

Ближайшие функциональные цели (MVP+):
- Глобальный поиск по проекту/документам — нужен уже на этапе MVP.
- История версий документа — нужна (точный объём/UX уточнить).
- Метрики/прогресс письма: цели, тайминг активности, средняя скорость печати (и т.п.).

## Recent WORKLOG (2026-01-23)
- UI: рамка `.editor-panel` приведена к разделителю sidebar (используется `var(--sidebar-border)` вместо более контрастной переменной).
- Toolbar: кнопка `min/max` перемещена в поток тулбара; добавлен компактный режим (скрытие части контролов) и переключение `min` ⇄ `max`.
- Toolbar: добавлены новые шрифты в font-select (Circe, Roboto Mono, American Typewriter) + добавлен селект “Styles” как одноразовая команда.
- Styles (MVP A): принято решение, что одного добавления маркеров недостаточно — нужен визуальный стиль.
- Editor: начата миграция с `textarea` на `contenteditable` для возможности стилизовать строки/фрагменты.
- Editor: добавлены базовые утилиты для plain text, обработка `paste` (только text/plain) и Enter (вставка `\n`).
- Editor: добавлен базовый рендер paragraph‑стилей + code fences (визуальное отличие по классам) и CSS‑переменные/стили под референсы.
- Открыто: inline стили `*...*` и `` `...` `` в отображении; возможные проблемы с undo/redo из-за перерендера.
- Docs: добавлен лёгкий процесс “Spec‑Lite” (`docs/PROCESS.md`) + шаблоны ТЗ/регресс‑проверок (`docs/templates/*`) + заметки по Spec Kit (`docs/references/spec-kit.md`).
- Docs: обновлён шаблон ТЗ под наш стиль “ТЗ для Codex” (контекст/ограничения → проблема → цель → что сделать → приёмка → тесты): `docs/templates/FEATURE_TZ.md`.
- Docs: добавлены “brain” утилиты для handoff/log/new-task (`scripts/brain.mjs`) + папка задач `docs/tasks/` + команды в `package.json`.
- Docs: добавлены git “save points” в процесс (`docs/PROCESS.md`) и команда `brain:savepoint` (подсказка для коммита по этапам).
- Docs: зафиксирована перспектива после MVP (платформы/облако/аккаунты/коллаб/экспорт/масштаб): `docs/CONTEXT.md`.
- Docs: добавлена структура для референсов (index + checklist + шаблон заметок): `docs/references/*`.
- Docs: добавлена база референсов по OSS проектам (`docs/references/ROADMAP.md` + `docs/references/projects/*.md`) и улучшен `brain:refs` (теги разбиваются на части).

## Tasks
- (no task files yet)

## Brain Commands
- `npm run brain:status`
- `npm run brain:handoff`
- `npm run brain:log -- "..."`
- `npm run brain:new-task -- "..."`
- `npm run brain:savepoint -- "..."`
- `npm run brain:refs -- "..."`
